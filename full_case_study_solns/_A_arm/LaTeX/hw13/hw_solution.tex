The single link robot arm is simulated using the following Python code.
\lstinputlisting[language=Python, caption=armSim.py]{../control_book_public_solutions/_a_arm/python/hw13/armSim.py}
Note that the input to the controller is the output $y$ corrupted by noise $n$ and that the input disturbance $d$ has been added to $u$.  The dataPlotObserver plots the state $x$ and the estimated state $\hat{x}$, as well as the disturbance $d$ and estimated disturbance $\hat{d}$, as will be discussed in the next chapter.  

A Python class that implements observer-based control with an integrator for the single link robot arm is shown below.
\lstinputlisting[language=Python, caption=armController.py]{../control_book_public_solutions/_a_arm/python/hw13/armController.py}
Notice that we must update the observer dynamics and that $\hat{x}$ is used in the controller instead of $x$, but otherwise this controller is identical to the controller in Chapter~\ref{chap:state-feedback-integrator}.  The observer is updated using the RK4 algorithm (see line~48).  The differential equations for the observer are also specified on lines~64--66.  

Python code that computes the control gains is given below.
\lstinputlisting[language=Python, caption=armParamHW13.py]{../control_book_public_solutions/_a_arm/python/hw13/armParamHW13.py}

Complete simulation code for Matlab, Python, and Simulink can be downloaded at \controlbookurl{http://controlbook.byu.edu}.
